#set( $role = $elem )
#set( $partnerRole = $role.PartnerRole )
#set( $ref = ($role.Adornment == 3) )
#set( $name = $role.AttrName )
#set( $type = $utility.getEMFTypeAsString($role.Target, $engine) )
#set( $transient = $role.Assoc.hasKeyInStereotypes("transient") )##FIX ME: transient possible? YES
#set( $ordered = $utility.isOrdered($role) )
#set( $containment = ($partnerRole.Adornment == 2) )
#set( $card = $role.Card )
#set( $comment = $utility.replaceTags($role.Comment.Text) )
#set( $ePackage = "${role.Target.declaredInPackage.name}.ecore")
#if ( $ePackage == "ecore.ecore")
#set( $ePackage = "platform:/plugin/org.eclipse.emf.ecore/model/Ecore.ecore")
#set( $type = "#//${role.Target}")
#end
#if (false) ##support to reference ecore classes
##if ( $role.Target.hasKeyInStereotypes("reference") )
##$engine.error("EMF does not support associations with stereotype 'reference' as target!",$elem)
#else
<eStructuralFeatures xsi:type="ecore:EReference" name="$name"#if( $containment ) eKeys="#foreach( $attrib in $role.Target.AllAttrs)#if( $attrib.hasKeyInStereotypes("id") )${type}/${attrib.name} #end#end"#end ordered="$ordered" lowerBound="$card.LowerBound" upperBound="##
#if ($card.UpperBound >= 2147483647 || $partnerRole.qualifier )## check, if upper cardinality is maxInt; FIX ME: qualifier results in to-n! todo: support keys
-1##
#else
$card.UpperBound##
#end
" eType="ecore:EClass $ePackage$type" transient="$transient" containment="$containment"#if( !$ref ) eOpposite="$type/$partnerRole.AttrName"#end>
#if( $comment )
  <eAnnotations source="http://www.eclipse.org/emf/2002/GenModel">
    <details key="documentation" value="$comment"/>
  </eAnnotations>
#end
</eStructuralFeatures>
#end